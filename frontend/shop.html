<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shop – Fashionz</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
  <header class="site-header" id="site-header">
    <div class="top-bar">
      <div class="container">
        <div class="d-flex justify-content-between align-items-center py-2">
          <a href="mailto:info@fashionz.com" class="text-decoration-none text-muted small"><i class="fas fa-envelope me-1"></i> info@fashionz.com</a>
          <span class="text-muted small"><i class="fas fa-phone me-1"></i> 010-020-0340</span>
        </div>
      </div>
    </div>
    <nav class="navbar navbar-expand-lg navbar-light">
      <div class="container">
        <a class="navbar-brand" href="index.html">Fashionz</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarMain" aria-controls="navbarMain" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarMain">
          <ul class="navbar-nav ms-auto align-items-lg-center">
            <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
            <li class="nav-item"><a class="nav-link" href="index.html#about">About</a></li>
            <li class="nav-item"><a class="nav-link active" href="shop.html">Shop</a></li>
            <li class="nav-item"><a class="nav-link" href="index.html#contact">Contact</a></li>
            <li class="nav-item" id="nav-login"><a class="nav-link" href="login.html">Login</a></li>
            <li class="nav-item d-none" id="nav-logout"><a class="nav-link" href="#" id="logout-link">Logout</a></li>
            <li class="nav-item">
              <a class="nav-link cart-link" href="cart.html" aria-label="Cart">
                <i class="fas fa-shopping-bag"></i>
                <span class="cart-count">0</span>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
  </header>

  <main class="section-pad">
    <div class="container">
      <h1 class="section-heading mb-4">Shop</h1>
      <div class="row g-4" id="shop-products">
        <div class="col-12 text-center py-5 text-muted">Loading…</div>
      </div>
    </div>
  </main>

  <footer class="site-footer">
    <div class="footer-bottom py-3">
      <div class="container text-center text-muted small">
        &copy; <span id="footer-year"></span> Fashionz.
      </div>
    </div>
  </footer>

  <script>window.API_BASE = 'http://localhost:5000';</script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="assets/js/state.js"></script>
  <script src="assets/js/auth.js"></script>
  <script src="assets/js/api.js"></script>
  <script src="assets/js/analytics.js"></script>
  <script src="assets/js/main.js"></script>
  <script>
    (function() {
      if (window.FashionzAuth && window.FashionzAuth.isLoggedIn && window.FashionzAuth.isLoggedIn()) {
        var loginEl = document.getElementById('nav-login');
        var logoutEl = document.getElementById('nav-logout');
        if (loginEl) loginEl.classList.add('d-none');
        if (logoutEl) logoutEl.classList.remove('d-none');
      }
      var logoutLink = document.getElementById('logout-link');
      if (logoutLink && window.FashionzAuth) {
        logoutLink.addEventListener('click', function(e) { e.preventDefault(); window.FashionzAuth.logout(); window.location.href = 'index.html'; });
      }
      var params = new URLSearchParams(window.location.search);
      var category = params.get('category') || '';
      var container = document.getElementById('shop-products');
      if (container && window.FashionzAPI) {
        var opts = {};
        if (category) opts.category = category;
        window.FashionzAPI.getProducts(opts).then(function(products) {
          if (window.FashionzAnalytics) window.FashionzAnalytics.pageView('/shop', 'Shop');
          container.innerHTML = products.map(function(p) {
            return '<div class="col-md-6 col-lg-3"><article class="product-card">' +
              '<a href="product.html?id=' + p.id + '" class="product-card-img-wrap"><div class="product-card-img" style="background-image: url(\'' + (p.image_url || '') + '\');"></div></a>' +
              '<div class="product-card-body"><p class="product-price">$' + (p.price || 0).toFixed(2) + '</p>' +
              '<h3 class="product-title"><a href="product.html?id=' + p.id + '">' + (p.title || '') + '</a></h3>' +
              '<p class="product-desc">' + (p.description || '').substring(0, 80) + (p.description && p.description.length > 80 ? '…' : '') + '</p>' +
              '<p class="product-reviews small text-muted">Reviews (' + (p.reviews_count || 0) + ')</p></div></article></div>';
          }).join('');
        }).catch(function() {
          container.innerHTML = '<div class="col-12 text-center py-5 text-muted">Unable to load products. Is the API running?</div>';
        });
      }
    })();
  </script>
</body>
</html>
